"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3634],{3905:(t,e,n)=>{n.d(e,{Zo:()=>m,kt:()=>k});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var p=a.createContext({}),d=function(t){var e=a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},m=function(t){var e=d(t.components);return a.createElement(p.Provider,{value:e},t.children)},s={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,p=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),u=d(n),k=r,N=u["".concat(p,".").concat(k)]||u[k]||s[k]||l;return n?a.createElement(N,i(i({ref:e},m),{},{components:n})):a.createElement(N,i({ref:e},m))}));function k(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,i=new Array(l);i[0]=u;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=t,o.mdxType="string"==typeof t?t:r,i[1]=o;for(var d=2;d<l;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},370:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>m,contentTitle:()=>p,default:()=>k,frontMatter:()=>o,metadata:()=>d,toc:()=>s});var a=n(7462),r=n(3366),l=(n(7294),n(3905)),i=["components"],o={id:"devops-guide-docker",title:"Self-Hosting Guide - Docker",sidebar_label:"Docker"},p=void 0,d={unversionedId:"devops-guide/devops-guide-docker",id:"devops-guide/devops-guide-docker",title:"Self-Hosting Guide - Docker",description:"Starting with release stable-7289-1 our images are provided with amd64 and arm64 architecture.",source:"@site/docs/devops-guide/docker.md",sourceDirName:"devops-guide",slug:"/devops-guide/devops-guide-docker",permalink:"/handbook/docs/devops-guide/devops-guide-docker",draft:!1,editUrl:"https://github.com/jitsi/handbook/edit/master/docs/devops-guide/docker.md",tags:[],version:"current",lastUpdatedAt:1725272189,formattedLastUpdatedAt:"Sep 2, 2024",frontMatter:{id:"devops-guide-docker",title:"Self-Hosting Guide - Docker",sidebar_label:"Docker"},sidebar:"docs",previous:{title:"openSUSE",permalink:"/handbook/docs/devops-guide/devops-guide-opensuse"},next:{title:"Log Analyser",permalink:"/handbook/docs/devops-guide/devops-guide-log-analyser"}},m={},s=[{value:"Quick start",id:"quick-start",level:2},{value:"Updating",id:"updating",level:3},{value:"Testing development / unstable builds",id:"testing-development--unstable-builds",level:3},{value:"Building your own images",id:"building-your-own-images",level:3},{value:"Security note",id:"security-note",level:3},{value:"Architecture",id:"architecture",level:2},{value:"External Ports",id:"external-ports",level:3},{value:"Images",id:"images",level:3},{value:"Design considerations",id:"design-considerations",level:3},{value:"Configuration",id:"configuration",level:2},{value:"TLS Configuration",id:"tls-configuration",level:3},{value:"Let&#39;s Encrypt configuration",id:"lets-encrypt-configuration",level:4},{value:"Using existing TLS certificate and key",id:"using-existing-tls-certificate-and-key",level:4},{value:"Features configuration (config.js)",id:"features-configuration-configjs",level:3},{value:"Jigasi SIP gateway (audio only) configuration",id:"jigasi-sip-gateway-audio-only-configuration",level:3},{value:"Display Dial-In information",id:"display-dial-in-information",level:4},{value:"Recording / live streaming configuration with Jibri",id:"recording--live-streaming-configuration-with-jibri",level:3},{value:"Jitsi Meet configuration",id:"jitsi-meet-configuration",level:3},{value:"Authentication",id:"authentication",level:3},{value:"Internal authentication",id:"internal-authentication",level:4},{value:"Authentication using LDAP",id:"authentication-using-ldap",level:4},{value:"Authentication using JWT tokens",id:"authentication-using-jwt-tokens",level:4},{value:"Authentication using Matrix",id:"authentication-using-matrix",level:4},{value:"Authentication using Hybrid Matrix Token",id:"authentication-using-hybrid-matrix-token",level:4},{value:"External authentication",id:"external-authentication",level:4},{value:"Shared document editing using Etherpad",id:"shared-document-editing-using-etherpad",level:3},{value:"Transcription configuration",id:"transcription-configuration",level:3},{value:"Sentry logging configuration",id:"sentry-logging-configuration",level:3},{value:"TURN server configuration",id:"turn-server-configuration",level:3},{value:"Advanced configuration",id:"advanced-configuration",level:3},{value:"Advanced Prosody options",id:"advanced-prosody-options",level:4},{value:"Advanced Jicofo options",id:"advanced-jicofo-options",level:4},{value:"Advanced JVB options",id:"advanced-jvb-options",level:4},{value:"Advanced Jigasi options",id:"advanced-jigasi-options",level:4},{value:"Running behind NAT or on a LAN environment",id:"running-behind-nat-or-on-a-lan-environment",level:3},{value:"Split horizon",id:"split-horizon",level:4},{value:"Offline / airgapped installation",id:"offline--airgapped-installation",level:4},{value:"Accessing server logs",id:"accessing-server-logs",level:2},{value:"Build Instructions",id:"build-instructions",level:2},{value:"Running behind a reverse proxy",id:"running-behind-a-reverse-proxy",level:2},{value:"Disabling WebSocket connections",id:"disabling-websocket-connections",level:3}],u={toc:s};function k(t){var e=t.components,o=(0,r.Z)(t,i);return(0,l.kt)("wrapper",(0,a.Z)({},u,o,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"Starting with release ",(0,l.kt)("inlineCode",{parentName:"p"},"stable-7289-1")," our images are provided with ",(0,l.kt)("inlineCode",{parentName:"p"},"amd64")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"arm64")," architecture.")),(0,l.kt)("h2",{id:"quick-start"},"Quick start"),(0,l.kt)("p",null,"In order to quickly run Jitsi Meet on a machine running Docker and Docker Compose,\nfollow these steps:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Download and extract the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/jitsi/docker-jitsi-meet/releases/latest"},"latest release"),". ",(0,l.kt)("strong",{parentName:"p"},"DO NOT")," clone the git repository. See below if you are interested in running test images:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"wget $(curl -s https://api.github.com/repos/jitsi/docker-jitsi-meet/releases/latest | grep 'zip' | cut -d\\\" -f4)\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Unzip the package:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"unzip <filename>\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Create a ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file by copying and adjusting ",(0,l.kt)("inlineCode",{parentName:"p"},"env.example"),":"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cp env.example .env\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Set strong passwords in the security section options of ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file by running the following bash script"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"./gen-passwords.sh\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Create required ",(0,l.kt)("inlineCode",{parentName:"p"},"CONFIG")," directories"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"For linux:")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p ~/.jitsi-meet-cfg/{web,transcripts,prosody/config,prosody/prosody-plugins-custom,jicofo,jvb,jigasi,jibri}\n")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"For Windows:")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'echo web,transcripts,prosody/config,prosody/prosody-plugins-custom,jicofo,jvb,jigasi,jibri | % { mkdir "~/.jitsi-meet-cfg/$_" }\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Run ",(0,l.kt)("inlineCode",{parentName:"p"},"docker compose up -d"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Access the web UI at ",(0,l.kt)("a",{parentName:"p",href:"https://localhost:8443"},(0,l.kt)("inlineCode",{parentName:"a"},"https://localhost:8443"))," (or a different port, in case you edited the ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file)."))),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"HTTP (not HTTPS) is also available (on port 8000, by default), but that's e.g. for a reverse proxy setup;\ndirect access via HTTP instead HTTPS leads to WebRTC errors such as\n",(0,l.kt)("em",{parentName:"p"},"Failed to access your microphone/camera: Cannot use microphone/camera for an unknown reason. Cannot read property 'getUserMedia' of undefined"),"\nor ",(0,l.kt)("em",{parentName:"p"},"navigator.mediaDevices is undefined"),".")),(0,l.kt)("p",null,"If you want to use jigasi too, first configure your env file with SIP credentials\nand then run Docker Compose as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose -f docker-compose.yml -f jigasi.yml up\n")),(0,l.kt)("p",null,"If you want to enable document sharing via ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/ether/etherpad-lite"},"Etherpad"),",\nconfigure it and run Docker Compose as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose -f docker-compose.yml -f etherpad.yml up\n")),(0,l.kt)("p",null,"If you want to use jibri too, first configure a host as described in Jitsi Broadcasting Infrastructure configuration section\nand then run Docker Compose as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose -f docker-compose.yml -f jibri.yml up -d\n")),(0,l.kt)("p",null,"or to use jigasi too:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose -f docker-compose.yml -f jigasi.yml -f jibri.yml up -d\n")),(0,l.kt)("p",null,"For the log analysis project, you will need both log-analyser.yml and grafana.yml files. This project allows you to analyze docker logs in grafana. If you want to run the log analyzer, run the Docker files as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose -f docker-compose.yml -f log-analyser.yml -f grafana.yml up -d\n")),(0,l.kt)("p",null,"Follow ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:3000/handbook/docs/devops-guide/devops-guide-log-analyser"},"this")," document for detailed information on log analysis."),(0,l.kt)("h3",{id:"updating"},"Updating"),(0,l.kt)("p",null,"If you want to update, simply run "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"wget $(curl -s https://api.github.com/repos/jitsi/docker-jitsi-meet/releases/latest | grep 'zip' | cut -d\\\" -f4)\n")),(0,l.kt)("p",null,"again (just like how you initially downloaded Jitsi). Then unzip and overwrite all when being asked:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"unzip <filename>\n")),(0,l.kt)("h3",{id:"testing-development--unstable-builds"},"Testing development / unstable builds"),(0,l.kt)("p",null,"Download the latest code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/jitsi/docker-jitsi-meet && cd docker-jitsi-meet\n")),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"The code in ",(0,l.kt)("inlineCode",{parentName:"p"},"master")," is designed to work with the unstable images. Do not run it with release images.")),(0,l.kt)("p",null,"Run ",(0,l.kt)("inlineCode",{parentName:"p"},"docker compose up")," as usual."),(0,l.kt)("p",null,'Every day a new "unstable" image build is uploaded.'),(0,l.kt)("h3",{id:"building-your-own-images"},"Building your own images"),(0,l.kt)("p",null,"Download the latest code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/jitsi/docker-jitsi-meet && cd docker-jitsi-meet\n")),(0,l.kt)("p",null,"The provided ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," provides a comprehensive way of building the whole stack or individual images."),(0,l.kt)("p",null,"To build all images:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"make\n")),(0,l.kt)("p",null,"To build a specific image (the web image for example):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"make build_web\n")),(0,l.kt)("p",null,"Once your local build is ready make sure to add ",(0,l.kt)("inlineCode",{parentName:"p"},"JITSI_IMAGE_VERSION=latest")," to your ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file."),(0,l.kt)("h3",{id:"security-note"},"Security note"),(0,l.kt)("p",null,"This setup used to have default passwords for internal accounts used across components.\nIn order to make the default setup secure by default these have been removed and the respective containers won't start without having a password set."),(0,l.kt)("p",null,"Strong passwords may be generated as follows: ",(0,l.kt)("inlineCode",{parentName:"p"},"./gen-passwords.sh"),"\nThis will modify your ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file (a backup is saved in ",(0,l.kt)("inlineCode",{parentName:"p"},".env.bak"),") and set strong passwords for each of the\nrequired options. Passwords are generated using ",(0,l.kt)("inlineCode",{parentName:"p"},"openssl rand -hex 16")," ."),(0,l.kt)("p",null,"DO NOT reuse any of the passwords."),(0,l.kt)("h2",{id:"architecture"},"Architecture"),(0,l.kt)("p",null,"A Jitsi Meet installation can be broken down into the following components:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"A web interface"),(0,l.kt)("li",{parentName:"ul"},"An XMPP server"),(0,l.kt)("li",{parentName:"ul"},"A conference focus component"),(0,l.kt)("li",{parentName:"ul"},"A video router (could be more than one)"),(0,l.kt)("li",{parentName:"ul"},"A SIP gateway for audio calls"),(0,l.kt)("li",{parentName:"ul"},"A Broadcasting Infrastructure for recording or streaming a conference.")),(0,l.kt)("p",null,(0,l.kt)("img",{src:n(168).Z,width:"882",height:"505"})),(0,l.kt)("p",null,"The diagram shows a typical deployment in a host running Docker. This project\nseparates each of the components above into interlinked containers. To this end,\nseveral container images are provided."),(0,l.kt)("h3",{id:"external-ports"},"External Ports"),(0,l.kt)("p",null,"The following external ports must be opened on a firewall:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"80/tcp")," for Web UI HTTP (really just to redirect, after uncommenting ",(0,l.kt)("inlineCode",{parentName:"li"},"ENABLE_HTTP_REDIRECT=1")," in ",(0,l.kt)("inlineCode",{parentName:"li"},".env"),")"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"443/tcp")," for Web UI HTTPS"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"10000/udp")," for RTP media over UDP")),(0,l.kt)("p",null,"Also ",(0,l.kt)("inlineCode",{parentName:"p"},"20000-20050/udp")," for jigasi, in case you choose to deploy that to facilitate SIP access."),(0,l.kt)("p",null,"E.g. on a CentOS/Fedora server this would be done like this (without SIP access):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sudo firewall-cmd --permanent --add-port=80/tcp\nsudo firewall-cmd --permanent --add-port=443/tcp\nsudo firewall-cmd --permanent --add-port=10000/udp\nsudo firewall-cmd --reload\n")),(0,l.kt)("p",null,"See ",(0,l.kt)("a",{parentName:"p",href:"https://jitsi.github.io/handbook/docs/devops-guide/devops-guide-quickstart#setup-and-configure-your-firewall"},"the corresponding section in the debian/ubuntu setup guide"),"."),(0,l.kt)("h3",{id:"images"},"Images"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"base"),": Debian stable base image with the ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/just-containers/s6-overlay"},"S6 Overlay")," for process control and the\n",(0,l.kt)("a",{parentName:"li",href:"https://jitsi.org/downloads/"},"Jitsi repositories")," enabled. All other images are based on this one."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"base-java"),": Same as the above, plus Java (OpenJDK)."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"web"),": Jitsi Meet web UI, served with nginx."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"prosody"),": ",(0,l.kt)("a",{parentName:"li",href:"https://prosody.im/"},"Prosody"),", the XMPP server."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"jicofo"),": ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/jitsi/jicofo"},"Jicofo"),", the XMPP focus component."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"jvb"),": ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/jitsi/jitsi-videobridge"},"Jitsi Videobridge"),", the video router."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"jigasi"),": ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/jitsi/jigasi"},"Jigasi"),", the SIP (audio only) gateway."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"jibri"),": ",(0,l.kt)("a",{parentName:"li",href:"https://github.com/jitsi/jibri"},"Jibri"),", the broadcasting infrastructure.")),(0,l.kt)("h3",{id:"design-considerations"},"Design considerations"),(0,l.kt)("p",null,"Jitsi Meet uses XMPP for signaling, thus the need for the XMPP server.\nThe setup provided by these containers does not expose the XMPP server to the outside world.\nInstead, it's kept completely sealed, and routing of XMPP traffic only happens on a user-defined network."),(0,l.kt)("p",null,"The XMPP server can be exposed to the outside world,\nbut that's out of the scope of this project."),(0,l.kt)("h2",{id:"configuration"},"Configuration"),(0,l.kt)("p",null,"The configuration is performed via environment variables contained in a ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," file.\nYou can copy the provided ",(0,l.kt)("inlineCode",{parentName:"p"},"env.example")," file as a reference."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"CONFIG")),(0,l.kt)("td",{parentName:"tr",align:null},"Directory where all configuration will be stored"),(0,l.kt)("td",{parentName:"tr",align:null},"/opt/jitsi-meet-cfg")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TZ")),(0,l.kt)("td",{parentName:"tr",align:null},"System Time Zone"),(0,l.kt)("td",{parentName:"tr",align:null},"Europe/Amsterdam")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"HTTP_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"Exposed port for HTTP traffic"),(0,l.kt)("td",{parentName:"tr",align:null},"8000")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"HTTPS_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"Exposed port for HTTPS traffic"),(0,l.kt)("td",{parentName:"tr",align:null},"8443")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_ADVERTISE_IPS")),(0,l.kt)("td",{parentName:"tr",align:null},"IP addresses of the Docker host (comma separated), needed for LAN environments"),(0,l.kt)("td",{parentName:"tr",align:null},"192.168.1.1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PUBLIC_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Public URL for the web service"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://meet.example.com"},"https://meet.example.com"))))),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"The mobile apps won't work with self-signed certificates (the default).\nSee below for instructions on how to obtain a proper certificate with Let's Encrypt.")),(0,l.kt)("h3",{id:"tls-configuration"},"TLS Configuration"),(0,l.kt)("h4",{id:"lets-encrypt-configuration"},"Let's Encrypt configuration"),(0,l.kt)("p",null,"If you want to expose your Jitsi Meet instance to the outside traffic directly, but don't own a proper TLS certificate, you are in luck\nbecause Let's Encrypt support is built right in. Here are the required options:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_LETSENCRYPT")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable Let's Encrypt certificate generation"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LETSENCRYPT_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Domain for which to generate the certificate"),(0,l.kt)("td",{parentName:"tr",align:null},"meet.example.com")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LETSENCRYPT_EMAIL")),(0,l.kt)("td",{parentName:"tr",align:null},"E-Mail for receiving important account notifications (mandatory)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"mailto:alice@atlanta.net"},"alice@atlanta.net"))))),(0,l.kt)("p",null,"In addition, you will need to set ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP_PORT")," to 80 and ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTPS_PORT")," to 443 and PUBLIC_URL to your domain.\nYou might also consider to redirect HTTP traffic to HTTPS by setting ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_HTTP_REDIRECT=1"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Let's Encrypt rate limit warning"),": Let's Encrypt has a limit to how many times you can submit a request\nfor a new certificate for your domain name. At the time of writing, the current limit is five new (duplicate)\ncertificates for the same domain name every seven days. Because of this, it is recommended that you disable the\nLet's Encrypt environment variables from ",(0,l.kt)("inlineCode",{parentName:"p"},".env")," if you plan on deleting the ",(0,l.kt)("inlineCode",{parentName:"p"},".jitsi-meet-cfg")," folder.\nOtherwise, you might want to consider moving the ",(0,l.kt)("inlineCode",{parentName:"p"},".jitsi-meet-cfg")," folder to a different location so you have a safe place to find\nthe certificate that already Let's Encrypt issued. Or do initial testing with Let's Encrypt disabled, then re-enable\nLet's Encrypt once you are done testing."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"When you move away from ",(0,l.kt)("inlineCode",{parentName:"p"},"LETSENCRYPT_USE_STAGING"),",\nyou will have to manually clear the certificates from ",(0,l.kt)("inlineCode",{parentName:"p"},".jitsi-meet-cfg/web"),".")),(0,l.kt)("p",null,"For more information on Let's Encrypt's rate limits, visit:\n",(0,l.kt)("a",{parentName:"p",href:"https://letsencrypt.org/docs/rate-limits/"},"https://letsencrypt.org/docs/rate-limits/")),(0,l.kt)("h4",{id:"using-existing-tls-certificate-and-key"},"Using existing TLS certificate and key"),(0,l.kt)("p",null,"If you own a proper TLS certificate and don't need a Let's Encrypt certificate, you can configure Jitsi Meet container\nto use it."),(0,l.kt)("p",null,"Unlike Let's Encrypt certificates, this is not configured through the ",(0,l.kt)("inlineCode",{parentName:"p"},".env"),"file, but by telling Jitsi Meet's ",(0,l.kt)("inlineCode",{parentName:"p"},"web")," service\nto mount the following two volumes:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"mount ",(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/your/cert.key")," file to ",(0,l.kt)("inlineCode",{parentName:"li"},"/config/keys/cert.key")," mount point"),(0,l.kt)("li",{parentName:"ul"},"mount ",(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/your/cert.fullchain")," file to the ",(0,l.kt)("inlineCode",{parentName:"li"},"/config/keys/cert.crt")," mount point.")),(0,l.kt)("p",null,"Doing it in ",(0,l.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file should look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"services:\n    web:\n        ...\n        volumes:\n            ...\n            - /path/to/your/cert.fullchain:/config/keys/cert.crt\n            - /path/to/your/cert.key:/config/keys/cert.key\n")),(0,l.kt)("h3",{id:"features-configuration-configjs"},"Features configuration (config.js)"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TOOLBAR_BUTTONS")),(0,l.kt)("td",{parentName:"tr",align:null},"Configure toolbar buttons. Add the buttons name separated with comma(no spaces between comma)"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"HIDE_PREMEETING_BUTTONS")),(0,l.kt)("td",{parentName:"tr",align:null},"Hide the buttons at pre-join screen. Add the buttons name separated with comma"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_LOBBY")),(0,l.kt)("td",{parentName:"tr",align:null},"Control whether the lobby feature should be enabled or not"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_AV_MODERATION")),(0,l.kt)("td",{parentName:"tr",align:null},"Control whether the A/V moderation should be enabled or not"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_PREJOIN_PAGE")),(0,l.kt)("td",{parentName:"tr",align:null},"Show a prejoin page before entering a conference"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_WELCOME_PAGE")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable the welcome page"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_CLOSE_PAGE")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable the close page"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"DISABLE_AUDIO_LEVELS")),(0,l.kt)("td",{parentName:"tr",align:null},"Disable measuring of audio levels"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_NOISY_MIC_DETECTION")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable noisy mic detection"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_BREAKOUT_ROOMS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable breakout rooms"),(0,l.kt)("td",{parentName:"tr",align:null},"1")))),(0,l.kt)("h3",{id:"jigasi-sip-gateway-audio-only-configuration"},"Jigasi SIP gateway (audio only) configuration"),(0,l.kt)("p",null,"If you want to enable the SIP gateway, these options are required:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_URI")),(0,l.kt)("td",{parentName:"tr",align:null},"SIP URI for incoming / outgoing calls"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"mailto:test@sip2sip.info"},"test@sip2sip.info"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_PASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null},"Password for the specified SIP account"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"<unset>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_SERVER")),(0,l.kt)("td",{parentName:"tr",align:null},"SIP server (use the SIP account domain if in doubt)"),(0,l.kt)("td",{parentName:"tr",align:null},"sip2sip.info")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"SIP server port"),(0,l.kt)("td",{parentName:"tr",align:null},"5060")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_TRANSPORT")),(0,l.kt)("td",{parentName:"tr",align:null},"SIP transport"),(0,l.kt)("td",{parentName:"tr",align:null},"UDP")))),(0,l.kt)("h4",{id:"display-dial-in-information"},"Display Dial-In information"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"DIALIN_NUMBERS_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"URL to the JSON with all Dial-In numbers"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://meet.example.com/dialin.json"},"https://meet.example.com/dialin.json"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"CONFCODE_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"URL to the API for checking/generating Dial-In codes"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://jitsi-api.jitsi.net/conferenceMapper"},"https://jitsi-api.jitsi.net/conferenceMapper"))))),(0,l.kt)("p",null,"The JSON with the Dial-In numbers should look like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{"message":"Dial-In numbers:","numbers":{"DE": ["+49-721-0000-0000"]},"numbersEnabled":true}\n')),(0,l.kt)("h3",{id:"recording--live-streaming-configuration-with-jibri"},"Recording / live streaming configuration with Jibri"),(0,l.kt)("details",null,(0,l.kt)("summary",null,"If you are using a release older than 7439 some extra setup is necessary."),"Before running Jibri **on releases older than 7439**, you need to set up an ALSA loopback device on the host. This **will not** work on a non-Linux host.",(0,l.kt)("p",null,"For CentOS 7, the module is already compiled with the kernel, so just run:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# configure 5 capture/playback interfaces\necho "options snd-aloop enable=1,1,1,1,1 index=0,1,2,3,4" > /etc/modprobe.d/alsa-loopback.conf\n# setup autoload the module\necho "snd_aloop" > /etc/modules-load.d/snd_aloop.conf\n# load the module\nmodprobe snd-aloop\n# check that the module is loaded\nlsmod | grep snd_aloop\n')),(0,l.kt)("p",null,"For Ubuntu:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# install the module\napt update && apt install linux-image-extra-virtual\n# configure 5 capture/playback interfaces\necho "options snd-aloop enable=1,1,1,1,1 index=0,1,2,3,4" > /etc/modprobe.d/alsa-loopback.conf\n# setup autoload the module\necho "snd-aloop" >> /etc/modules\n# check that the module is loaded\nlsmod | grep snd_aloop\n')),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},'If you are running on AWS you may need to reboot your machine to use the generic kernel instead\nof the "aws" kernel. If after reboot, your machine is still using the "aws" kernel, you\'ll need to manually update the grub file. So just run:')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# open the grub file in editor\nnano /etc/default/grub\n# Modify the value of GRUB_DEFAULT from "0" to "1>2"\n# Save and exit from file\n\n# Update grub\nupdate-grub\n# Reboot the machine\nreboot now\n')),(0,l.kt)("p",null,"For using multiple Jibri instances, you have to select different loopback interfaces for each instance manually."),(0,l.kt)("p",null,"  Default the first instance has:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'...\nslave.pcm "hw:Loopback,0,0"\n...\nslave.pcm "hw:Loopback,0,1"\n...\nslave.pcm "hw:Loopback,1,1"\n...\nslave.pcm "hw:Loopback,1,0"\n...\n')),(0,l.kt)("p",null,"  To setup the second instance, run container with changed ",(0,l.kt)("inlineCode",{parentName:"p"},"/home/jibri/.asoundrc"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'...\nslave.pcm "hw:Loopback_1,0,0"\n...\nslave.pcm "hw:Loopback_1,0,1"\n...\nslave.pcm "hw:Loopback_1,1,1"\n...\nslave.pcm "hw:Loopback_1,1,0"\n...\n')),(0,l.kt)("p",null,"  Also you can use numbering id for set loopback interface. The third instance will have ",(0,l.kt)("inlineCode",{parentName:"p"},".asoundrc")," that looks like:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'...\nslave.pcm "hw:2,0,0"\n...\nslave.pcm "hw:2,0,1"\n...\nslave.pcm "hw:2,1,1"\n...\nslave.pcm "hw:2,1,0"\n...\n\n'))),(0,l.kt)("p",null,"If you want to enable Jibri these options are required:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_RECORDING")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable recording / live streaming"),(0,l.kt)("td",{parentName:"tr",align:null},"1")))),(0,l.kt)("p",null,"Extended Jibri configuration:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_RECORDER_USER")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal recorder user for Jibri client connections"),(0,l.kt)("td",{parentName:"tr",align:null},"recorder")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_RECORDER_PASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal recorder password for Jibri client connections"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"<unset>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_RECORDING_DIR")),(0,l.kt)("td",{parentName:"tr",align:null},"Directory for recordings inside Jibri container"),(0,l.kt)("td",{parentName:"tr",align:null},"/config/recordings")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_FINALIZE_RECORDING_SCRIPT_PATH")),(0,l.kt)("td",{parentName:"tr",align:null},"The finalizing script. Will run after recording is complete"),(0,l.kt)("td",{parentName:"tr",align:null},"/config/finalize.sh")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_XMPP_USER")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal user for Jibri client connections."),(0,l.kt)("td",{parentName:"tr",align:null},"jibri")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_STRIP_DOMAIN_JID")),(0,l.kt)("td",{parentName:"tr",align:null},"Prefix domain for strip inside Jibri (please see env.example for details)"),(0,l.kt)("td",{parentName:"tr",align:null},"muc")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_BREWERY_MUC")),(0,l.kt)("td",{parentName:"tr",align:null},"MUC name for the Jibri pool"),(0,l.kt)("td",{parentName:"tr",align:null},"jibribrewery")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIBRI_PENDING_TIMEOUT")),(0,l.kt)("td",{parentName:"tr",align:null},"MUC connection timeout"),(0,l.kt)("td",{parentName:"tr",align:null},"90")))),(0,l.kt)("h3",{id:"jitsi-meet-configuration"},"Jitsi Meet configuration"),(0,l.kt)("p",null,"Jitsi-Meet uses two configuration files for changing default settings within\nthe web interface: ",(0,l.kt)("inlineCode",{parentName:"p"},"config.js")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"interface_config.js"),". The files are\nlocated within the ",(0,l.kt)("inlineCode",{parentName:"p"},"CONFIG/web/")," directory configured within your environment file."),(0,l.kt)("p",null,"These files are re-created on every container restart.\nIf you'd like to provide your own settings, create your own config files:\n",(0,l.kt)("inlineCode",{parentName:"p"},"custom-config.js")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"custom-interface_config.js"),"."),(0,l.kt)("p",null,"It's enough to provide your relevant settings only, the docker scripts will\nappend your custom files to the default ones!"),(0,l.kt)("h3",{id:"authentication"},"Authentication"),(0,l.kt)("p",null,"Authentication can be controlled with the environment variables below. If guest\naccess is enabled, unauthenticated users will need to wait until a user authenticates\nbefore they can join a room. If guest access is not enabled, every user will need\nto authenticate before they can join."),(0,l.kt)("p",null,"If authentication is enabled, once an authenticated user logged in, it is always\nlogged in before the session timeout. You can set ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_AUTO_LOGIN=0")," to disable\nthis default auto login feature or you can set ",(0,l.kt)("inlineCode",{parentName:"p"},"JICOFO_AUTH_LIFETIME")," to limit\nthe session lifetime."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_AUTH")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable authentication"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_GUESTS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable guest access"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTH_TYPE")),(0,l.kt)("td",{parentName:"tr",align:null},"Select authentication type (internal, jwt or ldap)"),(0,l.kt)("td",{parentName:"tr",align:null},"internal")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_AUTO_LOGIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable auto login"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_AUTH_LIFETIME")),(0,l.kt)("td",{parentName:"tr",align:null},"Select session timeout value for an authenticated user"),(0,l.kt)("td",{parentName:"tr",align:null},"3 hours")))),(0,l.kt)("h4",{id:"internal-authentication"},"Internal authentication"),(0,l.kt)("p",null,"The default authentication mode (",(0,l.kt)("inlineCode",{parentName:"p"},"internal"),") uses XMPP credentials to authenticate users.\nTo enable it you have to enable authentication with ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_AUTH")," and set ",(0,l.kt)("inlineCode",{parentName:"p"},"AUTH_TYPE")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"internal"),",\nthen configure the settings you can see below."),(0,l.kt)("p",null,"Internal users must be created with the ",(0,l.kt)("inlineCode",{parentName:"p"},"prosodyctl")," utility in the ",(0,l.kt)("inlineCode",{parentName:"p"},"prosody")," container.\nIn order to do that, first, execute a shell in the corresponding container:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose exec prosody /bin/bash\n")),(0,l.kt)("p",null,"Once in the container, run the following command to create a user:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"prosodyctl --config /config/prosody.cfg.lua register TheDesiredUsername meet.jitsi TheDesiredPassword\n")),(0,l.kt)("p",null,"Note that the command produces no output."),(0,l.kt)("p",null,"To delete a user, run the following command in the container:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"prosodyctl --config /config/prosody.cfg.lua unregister TheDesiredUsername meet.jitsi\n")),(0,l.kt)("p",null,"To list all users, run the following command in the container:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"find /config/data/meet%2ejitsi/accounts -type f -exec basename {} .dat \\;\n")),(0,l.kt)("h4",{id:"authentication-using-ldap"},"Authentication using LDAP"),(0,l.kt)("p",null,"You can use LDAP to authenticate users. To enable it you have to enable authentication with ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_AUTH")," and\nset ",(0,l.kt)("inlineCode",{parentName:"p"},"AUTH_TYPE")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"ldap"),", then configure the settings you can see below."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"URL for ldap connection"),(0,l.kt)("td",{parentName:"tr",align:null},"ldaps://ldap.domain.com/")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_BASE")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP base DN. Can be empty."),(0,l.kt)("td",{parentName:"tr",align:null},"DC=example,DC=domain,DC=com")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_BINDDN")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP user DN. Do not specify this parameter for the anonymous bind."),(0,l.kt)("td",{parentName:"tr",align:null},"CN=binduser,OU=users,DC=example,DC=domain,DC=com")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_BINDPW")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP user password. Do not specify this parameter for the anonymous bind."),(0,l.kt)("td",{parentName:"tr",align:null},"LdapUserPassw0rd")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_FILTER")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP filter."),(0,l.kt)("td",{parentName:"tr",align:null},"(sAMAccountName=%u)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_AUTH_METHOD")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP authentication method."),(0,l.kt)("td",{parentName:"tr",align:null},"bind")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_VERSION")),(0,l.kt)("td",{parentName:"tr",align:null},"LDAP protocol version"),(0,l.kt)("td",{parentName:"tr",align:null},"3")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_USE_TLS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable LDAP TLS"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_TLS_CIPHERS")),(0,l.kt)("td",{parentName:"tr",align:null},"Set TLS ciphers list to allow"),(0,l.kt)("td",{parentName:"tr",align:null},"SECURE256:SECURE128")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_TLS_CHECK_PEER")),(0,l.kt)("td",{parentName:"tr",align:null},"Require and verify LDAP server certificate"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_TLS_CACERT_FILE")),(0,l.kt)("td",{parentName:"tr",align:null},"Path to CA cert file. Used when server certificate verification is enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"/etc/ssl/certs/ca-certificates.crt")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_TLS_CACERT_DIR")),(0,l.kt)("td",{parentName:"tr",align:null},"Path to CA certs directory. Used when server certificate verification is enabled."),(0,l.kt)("td",{parentName:"tr",align:null},"/etc/ssl/certs")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LDAP_START_TLS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable START_TLS, requires LDAPv3, URL must be ldap:// not ldaps://"),(0,l.kt)("td",{parentName:"tr",align:null},"0")))),(0,l.kt)("h4",{id:"authentication-using-jwt-tokens"},"Authentication using JWT tokens"),(0,l.kt)("p",null,"You can use JWT tokens to authenticate users. To enable it you have to enable authentication with ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_AUTH")," and\nset ",(0,l.kt)("inlineCode",{parentName:"p"},"AUTH_TYPE")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"jwt"),", then configure the settings you can see below."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_APP_ID")),(0,l.kt)("td",{parentName:"tr",align:null},"Application identifier"),(0,l.kt)("td",{parentName:"tr",align:null},"my_jitsi_app_id")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_APP_SECRET")),(0,l.kt)("td",{parentName:"tr",align:null},"Application secret known only to your token"),(0,l.kt)("td",{parentName:"tr",align:null},"my_jitsi_app_secret")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_ACCEPTED_ISSUERS")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Set asap_accepted_issuers as a comma separated list"),(0,l.kt)("td",{parentName:"tr",align:null},"my_web_client,my_app_client")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_ACCEPTED_AUDIENCES")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Set asap_accepted_audiences as a comma separated list"),(0,l.kt)("td",{parentName:"tr",align:null},"my_server1,my_server2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_ASAP_KEYSERVER")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Set asap_keyserver to a url where public keys can be found"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://example.com/asap%3E"},"https://example.com/asap>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_ALLOW_EMPTY")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Allow anonymous users with no JWT while validating JWTs when provided"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_AUTH_TYPE")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Controls which module is used for processing incoming JWTs"),(0,l.kt)("td",{parentName:"tr",align:null},"token")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_TOKEN_AUTH_MODULE")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Controls which module is used for validating JWTs"),(0,l.kt)("td",{parentName:"tr",align:null},"token_verification")))),(0,l.kt)("p",null,"This can be tested using the ",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io/#debugger-io"},"jwt.io")," debugger. Use the following sample payload:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "context": {\n    "user": {\n      "avatar": "https://robohash.org/john-doe",\n      "name": "John Doe",\n      "email": "jdoe@example.com"\n    }\n  },\n  "aud": "my_jitsi_app_id",\n  "iss": "my_jitsi_app_id",\n  "sub": "meet.jitsi",\n  "room": "*"\n}\n')),(0,l.kt)("h4",{id:"authentication-using-matrix"},"Authentication using Matrix"),(0,l.kt)("p",null,'For more information see the documentation of the "Prosody Auth Matrix User Verification" ',(0,l.kt)("a",{parentName:"p",href:"https://github.com/matrix-org/prosody-mod-auth-matrix-user-verification"},"here"),"."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Base URL to the matrix user verification service (without ending slash)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://uvs.example.com:3000%3E"},"https://uvs.example.com:3000>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_ISSUER")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) The issuer of the auth token to be passed through. Must match what is being set as ",(0,l.kt)("inlineCode",{parentName:"td"},"iss")," in the JWT."),(0,l.kt)("td",{parentName:"tr",align:null},"issuer (default)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_AUTH_TOKEN")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) user verification service auth token, if authentication enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"changeme")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_SYNC_POWER_LEVELS")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) Make Matrix room moderators owners of the Prosody room."),(0,l.kt)("td",{parentName:"tr",align:null},"1")))),(0,l.kt)("h4",{id:"authentication-using-hybrid-matrix-token"},"Authentication using Hybrid Matrix Token"),(0,l.kt)("p",null,"You can use ",(0,l.kt)("inlineCode",{parentName:"p"},"Hybrid Matrix Token")," to authenticate users. It supports ",(0,l.kt)("inlineCode",{parentName:"p"},"Matrix")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"JWT Token")," authentications\non the same setup. To enable it you have to enable authentication with ",(0,l.kt)("inlineCode",{parentName:"p"},"ENABLE_AUTH")," and set ",(0,l.kt)("inlineCode",{parentName:"p"},"AUTH_TYPE")," to\n",(0,l.kt)("inlineCode",{parentName:"p"},"hybrid_matrix_token"),", then configure the settings you can see below."),(0,l.kt)("p",null,'For more information see the documentation of the "Hybrid Matrix Token"\n',(0,l.kt)("a",{parentName:"p",href:"https://github.com/jitsi-contrib/prosody-plugins/tree/main/auth_hybrid_matrix_token"},"here"),"."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Base URL to the matrix user verification service (without ending slash)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://uvs.example.com:3000%3E"},"https://uvs.example.com:3000>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_ISSUER")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) The issuer of the auth token to be passed through. Must match what is being set as ",(0,l.kt)("inlineCode",{parentName:"td"},"iss")," in the JWT. It allows all issuers (",(0,l.kt)("inlineCode",{parentName:"td"},"*"),") by default."),(0,l.kt)("td",{parentName:"tr",align:null},"my_issuer")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_AUTH_TOKEN")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) user verification service auth token, if authentication enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"my_matrix_secret")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_UVS_SYNC_POWER_LEVELS")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) Make Matrix room moderators owners of the Prosody room."),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"MATRIX_LOBBY_BYPASS")),(0,l.kt)("td",{parentName:"tr",align:null},"(optional) Allow Matrix room members to bypass Jitsi lobby check."),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_APP_ID")),(0,l.kt)("td",{parentName:"tr",align:null},"Application identifier"),(0,l.kt)("td",{parentName:"tr",align:null},"my_jitsi_app_id")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_APP_SECRET")),(0,l.kt)("td",{parentName:"tr",align:null},"Application secret known only to your token"),(0,l.kt)("td",{parentName:"tr",align:null},"my_jitsi_app_secret")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JWT_ALLOW_EMPTY")),(0,l.kt)("td",{parentName:"tr",align:null},"(Optional) Allow anonymous users with no JWT while validating JWTs when provided"),(0,l.kt)("td",{parentName:"tr",align:null},"0")))),(0,l.kt)("h4",{id:"external-authentication"},"External authentication"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TOKEN_AUTH_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Authenticate using external service or just focus external auth window if there is one already."),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"https://auth.meet.example.com/%7Broom%7D%3E"},"https://auth.meet.example.com/{room}>"))))),(0,l.kt)("h3",{id:"shared-document-editing-using-etherpad"},"Shared document editing using Etherpad"),(0,l.kt)("p",null,"You can collaboratively edit a document via ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/ether/etherpad-lite"},"Etherpad"),". In order to enable it, set the config options below and run\nDocker Compose with the additional config file ",(0,l.kt)("inlineCode",{parentName:"p"},"etherpad.yml"),"."),(0,l.kt)("p",null,"Here are the required options:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ETHERPAD_URL_BASE")),(0,l.kt)("td",{parentName:"tr",align:null},"Set etherpad-lite URL"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"http://etherpad.meet.jitsi:9001%3E"},"http://etherpad.meet.jitsi:9001>"))))),(0,l.kt)("h3",{id:"transcription-configuration"},"Transcription configuration"),(0,l.kt)("p",null,"If you want to enable the Transcribing function, these options are required:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_TRANSCRIPTIONS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable Jigasi transcription in a conference"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_PROJECT_ID")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"project_id")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_PRIVATE_KEY_ID")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"private_key_id")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_PRIVATE_KEY")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"private_key")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_CLIENT_EMAIL")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"client_email")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_CLIENT_ID")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"client_id")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GC_CLIENT_CERT_URL")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"client_x509_cert_url")," from Google Cloud Credentials"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_TRANSCRIBER_RECORD_AUDIO")),(0,l.kt)("td",{parentName:"tr",align:null},"Jigasi will record audio when transcriber is on"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_TRANSCRIBER_SEND_TXT")),(0,l.kt)("td",{parentName:"tr",align:null},"Jigasi will send transcribed text to the chat when transcriber is on"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_TRANSCRIBER_ADVERTISE_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Jigasi will post an url to the chat with transcription file"),(0,l.kt)("td",{parentName:"tr",align:null},"true")))),(0,l.kt)("p",null,"For setting the Google Cloud Credentials please read ",(0,l.kt)("a",{parentName:"p",href:"https://cloud.google.com/text-to-speech/docs/quickstart-protocol%3E"},"https://cloud.google.com/text-to-speech/docs/quickstart-protocol>"),' section "Before you begin" paragraph 1 to 5.'),(0,l.kt)("h3",{id:"sentry-logging-configuration"},"Sentry logging configuration"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_SENTRY_DSN")),(0,l.kt)("td",{parentName:"tr",align:null},"Sentry Data Source Name (Endpoint for Sentry project)"),(0,l.kt)("td",{parentName:"tr",align:null},"https://public:private@host:port/1>")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_SENTRY_DSN")),(0,l.kt)("td",{parentName:"tr",align:null},"Sentry Data Source Name (Endpoint for Sentry project)"),(0,l.kt)("td",{parentName:"tr",align:null},"https://public:private@host:port/1>")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SENTRY_DSN")),(0,l.kt)("td",{parentName:"tr",align:null},"Sentry Data Source Name (Endpoint for Sentry project)"),(0,l.kt)("td",{parentName:"tr",align:null},"https://public:private@host:port/1>")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SENTRY_ENVIRONMENT")),(0,l.kt)("td",{parentName:"tr",align:null},"Optional environment info to filter events"),(0,l.kt)("td",{parentName:"tr",align:null},"production")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SENTRY_RELEASE")),(0,l.kt)("td",{parentName:"tr",align:null},"Optional release info to filter events"),(0,l.kt)("td",{parentName:"tr",align:null},"1.0.0")))),(0,l.kt)("h3",{id:"turn-server-configuration"},"TURN server configuration"),(0,l.kt)("p",null,"Configure external TURN servers."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURN_CREDENTIALS")),(0,l.kt)("td",{parentName:"tr",align:null},"Credentials for TURN servers"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURN_HOST")),(0,l.kt)("td",{parentName:"tr",align:null},"TURN server hostnames as a comma separated list (UDP or TCP transport)"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURN_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"TURN server port (UDP or TCP transport)"),(0,l.kt)("td",{parentName:"tr",align:null},"443")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURN_TRANSPORT")),(0,l.kt)("td",{parentName:"tr",align:null},"TURN server protocols as a comma separated list (UDP or TCP or both)"),(0,l.kt)("td",{parentName:"tr",align:null},"tcp")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURNS_HOST")),(0,l.kt)("td",{parentName:"tr",align:null},"TURN server hostnames as a comma separated list (TLS transport)"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TURNS_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"TURN server port (TLS transport)"),(0,l.kt)("td",{parentName:"tr",align:null},"443")))),(0,l.kt)("h3",{id:"advanced-configuration"},"Advanced configuration"),(0,l.kt)("p",null,"These configuration options are already set and generally don't need to be changed."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal XMPP domain"),(0,l.kt)("td",{parentName:"tr",align:null},"meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_AUTH_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal XMPP domain for authenticated services"),(0,l.kt)("td",{parentName:"tr",align:null},"auth.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_SERVER")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal XMPP server name xmpp.meet.jitsi"),(0,l.kt)("td",{parentName:"tr",align:null},"xmpp.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_BOSH_URL_BASE")),(0,l.kt)("td",{parentName:"tr",align:null},"Internal XMPP server URL for BOSH module"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("a",{parentName:"td",href:"http://xmpp.meet.jitsi:5280%3E"},"http://xmpp.meet.jitsi:5280>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_MUC_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP domain for the MUC"),(0,l.kt)("td",{parentName:"tr",align:null},"muc.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_INTERNAL_MUC_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP domain for the internal MUC"),(0,l.kt)("td",{parentName:"tr",align:null},"internal-muc.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_GUEST_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP domain for unauthenticated users"),(0,l.kt)("td",{parentName:"tr",align:null},"guest.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_RECORDER_DOMAIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Domain for the jibri recorder"),(0,l.kt)("td",{parentName:"tr",align:null},"recorder.meet.jitsi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_MODULES")),(0,l.kt)("td",{parentName:"tr",align:null},"Custom Prosody modules for XMPP_DOMAIN (comma separated)"),(0,l.kt)("td",{parentName:"tr",align:null},"info,alert")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_MUC_MODULES")),(0,l.kt)("td",{parentName:"tr",align:null},"Custom Prosody modules for MUC component (comma separated)"),(0,l.kt)("td",{parentName:"tr",align:null},"info,alert")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"XMPP_INTERNAL_MUC_MODULES")),(0,l.kt)("td",{parentName:"tr",align:null},"Custom Prosody modules for internal MUC component (comma separated)"),(0,l.kt)("td",{parentName:"tr",align:null},"info,alert")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GLOBAL_MODULES")),(0,l.kt)("td",{parentName:"tr",align:null},"Custom prosody modules to load in global configuration (comma separated)"),(0,l.kt)("td",{parentName:"tr",align:null},"statistics,alert")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GLOBAL_CONFIG")),(0,l.kt)("td",{parentName:"tr",align:null},"Custom configuration string with escaped newlines"),(0,l.kt)("td",{parentName:"tr",align:null},"foo = bar;\\nkey = val;")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"RESTART_POLICY")),(0,l.kt)("td",{parentName:"tr",align:null},"Container restart policy"),(0,l.kt)("td",{parentName:"tr",align:null},"defaults to ",(0,l.kt)("inlineCode",{parentName:"td"},"unless-stopped"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"DISABLE_HTTPS")),(0,l.kt)("td",{parentName:"tr",align:null},"Handle TLS connections outside of this setup"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_HTTP_REDIRECT")),(0,l.kt)("td",{parentName:"tr",align:null},"Redirect HTTP traffic to HTTPS"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"LOG_LEVEL")),(0,l.kt)("td",{parentName:"tr",align:null},"Controls which logs are output from prosody and associated modules"),(0,l.kt)("td",{parentName:"tr",align:null},"info")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_HSTS")),(0,l.kt)("td",{parentName:"tr",align:null},"Send a ",(0,l.kt)("inlineCode",{parentName:"td"},"strict-transport-security")," header to force browsers to use a secure and trusted connection. Recommended for production use."),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_IPV6")),(0,l.kt)("td",{parentName:"tr",align:null},"Provides means to disable IPv6 in environments that don't support it"),(0,l.kt)("td",{parentName:"tr",align:null},"1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_COLIBRI_WEBSOCKET_UNSAFE_REGEX")),(0,l.kt)("td",{parentName:"tr",align:null},"Enabled older unsafe regex for JVB colibri-ws URLs. WARNING: Enable with caution, this regex allows connections to arbitrary internal IP addresses and is not recommended for production use.  Unsafe regex is defined as ",(0,l.kt)("inlineCode",{parentName:"td"},"[a-zA-Z0-9-\\._]+")),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"COLIBRI_WEBSOCKET_JVB_LOOKUP_NAME")),(0,l.kt)("td",{parentName:"tr",align:null},"DNS name to look up JVB IP address, used for default value of ",(0,l.kt)("inlineCode",{parentName:"td"},"COLIBRI_WEBSOCKET_REGEX")),(0,l.kt)("td",{parentName:"tr",align:null},"jvb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"COLIBRI_WEBSOCKET_REGEX")),(0,l.kt)("td",{parentName:"tr",align:null},"Overrides the colibri regex used for proxying to JVB.  Recommended to override in production with values matching possible JVB IP ranges"),(0,l.kt)("td",{parentName:"tr",align:null},"defaults to ",(0,l.kt)("inlineCode",{parentName:"td"},"dig $COLIBRI_WEBSOCKET_JVB_LOOKUP_NAME")," unless ",(0,l.kt)("inlineCode",{parentName:"td"},"DISABLE_COLIBRI_WEBSOCKET_JVB_LOOKUP")," is set to true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"DISABLE_COLIBRI_WEBSOCKET_JVB_LOOKUP")),(0,l.kt)("td",{parentName:"tr",align:null},"Controls whether to run ",(0,l.kt)("inlineCode",{parentName:"td"},"dig $COLIBRI_WEBSOCKET_JVB_LOOKUP_NAME")," when defining COLIBRI_WEBSOCKET_REGEX"),(0,l.kt)("td",{parentName:"tr",align:null},"0")))),(0,l.kt)("h4",{id:"advanced-prosody-options"},"Advanced Prosody options"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PROSODY_RESERVATION_ENABLED")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable Prosody's reservation REST API"),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PROSODY_RESERVATION_REST_BASE_URL")),(0,l.kt)("td",{parentName:"tr",align:null},"Base URL of Prosody's reservation REST API"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PROSODY_AUTH_TYPE")),(0,l.kt)("td",{parentName:"tr",align:null},"Select authentication type for Prosody (internal, jwt or ldap)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTH_TYPE"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PROSODY_ENABLE_METRICS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enables the http_openmetrics module which exposes Prometheus metrics at ",(0,l.kt)("inlineCode",{parentName:"td"},"/metrics")),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PROSODY_METRICS_ALLOWED_CIDR")),(0,l.kt)("td",{parentName:"tr",align:null},"CIDR block permitted to access metrics"),(0,l.kt)("td",{parentName:"tr",align:null},"172.16.0.0/12")))),(0,l.kt)("h4",{id:"advanced-jicofo-options"},"Advanced Jicofo options"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_COMPONENT_SECRET")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP component password for Jicofo"),(0,l.kt)("td",{parentName:"tr",align:null},"s3cr37")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_AUTH_USER")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP user for Jicofo client connections"),(0,l.kt)("td",{parentName:"tr",align:null},"focus")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_AUTH_PASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP password for Jicofo client connections"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"<unset>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_ENABLE_AUTH")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable authentication in Jicofo"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ENABLE_AUTH"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_AUTH_TYPE")),(0,l.kt)("td",{parentName:"tr",align:null},"Select authentication type for Jicofo (internal, jwt or ldap)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTH_TYPE"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_AUTH_LIFETIME")),(0,l.kt)("td",{parentName:"tr",align:null},"Select session timeout value for an authenticated user"),(0,l.kt)("td",{parentName:"tr",align:null},"24 hours")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JICOFO_ENABLE_HEALTH_CHECKS")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable health checks inside Jicofo, allowing the use of the REST api to check Jicofo's status"),(0,l.kt)("td",{parentName:"tr",align:null},"false")))),(0,l.kt)("h4",{id:"advanced-jvb-options"},"Advanced JVB options"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_AUTH_USER")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP user for JVB MUC client connections"),(0,l.kt)("td",{parentName:"tr",align:null},"jvb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_AUTH_PASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP password for JVB MUC client connections"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"<unset>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_STUN_SERVERS")),(0,l.kt)("td",{parentName:"tr",align:null},"STUN servers used to discover the server's public IP"),(0,l.kt)("td",{parentName:"tr",align:null},"stun.l.google.com:19302, stun1.l.google.com:19302, stun2.l.google.com:19302")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"UDP port for media used by Jitsi Videobridge"),(0,l.kt)("td",{parentName:"tr",align:null},"10000")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_COLIBRI_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"COLIBRI REST API port of JVB exposed to localhost"),(0,l.kt)("td",{parentName:"tr",align:null},"8080")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JVB_BREWERY_MUC")),(0,l.kt)("td",{parentName:"tr",align:null},"MUC name for the JVB pool"),(0,l.kt)("td",{parentName:"tr",align:null},"jvbbrewery")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"COLIBRI_REST_ENABLED")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable the COLIBRI REST API"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SHUTDOWN_REST_ENABLED")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable the shutdown REST API"),(0,l.kt)("td",{parentName:"tr",align:null},"true")))),(0,l.kt)("h4",{id:"advanced-jigasi-options"},"Advanced Jigasi options"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Variable"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_ENABLE_SDES_SRTP")),(0,l.kt)("td",{parentName:"tr",align:null},"Enable SDES srtp"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_SIP_KEEP_ALIVE_METHOD")),(0,l.kt)("td",{parentName:"tr",align:null},"Keepalive method"),(0,l.kt)("td",{parentName:"tr",align:null},"OPTIONS")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_HEALTH_CHECK_SIP_URI")),(0,l.kt)("td",{parentName:"tr",align:null},"Health-check extension"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_HEALTH_CHECK_INTERVAL")),(0,l.kt)("td",{parentName:"tr",align:null},"Health-check interval"),(0,l.kt)("td",{parentName:"tr",align:null},"300000")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_XMPP_USER")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP user for Jigasi MUC client connections"),(0,l.kt)("td",{parentName:"tr",align:null},"jigasi")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_XMPP_PASSWORD")),(0,l.kt)("td",{parentName:"tr",align:null},"XMPP password for Jigasi MUC client connections"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"<unset>"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_BREWERY_MUC")),(0,l.kt)("td",{parentName:"tr",align:null},"MUC name for the Jigasi pool"),(0,l.kt)("td",{parentName:"tr",align:null},"jigasibrewery")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_PORT_MIN")),(0,l.kt)("td",{parentName:"tr",align:null},"Minimum port for media used by Jigasi"),(0,l.kt)("td",{parentName:"tr",align:null},"20000")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"JIGASI_PORT_MAX")),(0,l.kt)("td",{parentName:"tr",align:null},"Maximum port for media used by Jigasi"),(0,l.kt)("td",{parentName:"tr",align:null},"20050")))),(0,l.kt)("h3",{id:"running-behind-nat-or-on-a-lan-environment"},"Running behind NAT or on a LAN environment"),(0,l.kt)("p",null,"When running running in a LAN environment, or on the public Internet via NAT, the ",(0,l.kt)("inlineCode",{parentName:"p"},"JVB_ADVERTISE_IPS")," env variable should be set.\nThis variable allows to control which IP addresses the JVB will advertise for WebRTC media traffic."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"This variable used to be called ",(0,l.kt)("inlineCode",{parentName:"p"},"DOCKER_HOST_ADDRESS")," but it got renamed for clarity and to support a list of IPs.")),(0,l.kt)("p",null,"If your users are coming in over the Internet (and not over LAN), this will likely be your public IP address. If this is not set up correctly, calls will crash when more than two users join a meeting."),(0,l.kt)("p",null,"The public IP address is attempted to be discovered via ",(0,l.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/STUN"},"STUN"),".\nSTUN servers can be specified with the ",(0,l.kt)("inlineCode",{parentName:"p"},"JVB_STUN_SERVERS")," option."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"Due to a bug in the docker version currently in the Debian repos (20.10.5), ",(0,l.kt)("a",{parentName:"p",href:"https://forums.docker.com/t/docker-doesnt-open-ipv6-ports/106201/2"},"Docker does not listen on IPv6 ports"),", so for that combination you will have to ",(0,l.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/install/debian/"},"manually obtain the latest version"),".")),(0,l.kt)("h4",{id:"split-horizon"},"Split horizon"),(0,l.kt)("p",null,"If you are running in a split horizon environemt (LAN internal clients connect to a local IP and other clients connect to a public IP) you can specify\nmultiple advertised IPs by separating them with commas:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"JVB_ADVERTISE_IPS=192.168.1.1,1.2.3.4\n")),(0,l.kt)("h4",{id:"offline--airgapped-installation"},"Offline / airgapped installation"),(0,l.kt)("p",null,"If your setup does not have access to the Internet you'll need to disable STUN on the JVB since discovering its own IP address will fail, but that is not necessary on that type of environment."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"JVB_DISABLE_STUN=true\n")),(0,l.kt)("h2",{id:"accessing-server-logs"},"Accessing server logs"),(0,l.kt)("p",null,"The default bahavior of ",(0,l.kt)("inlineCode",{parentName:"p"},"docker-jitsi-meet")," is to log to ",(0,l.kt)("inlineCode",{parentName:"p"},"stdout"),"."),(0,l.kt)("p",null,"While the logs are sent to ",(0,l.kt)("inlineCode",{parentName:"p"},"stdout"),", they are not lost: unless configured to drop all logs, Docker keeps them available for future retrieval and processing."),(0,l.kt)("p",null,"If you need to access the container's logs you have multiple options. Here are the main ones:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"run ",(0,l.kt)("inlineCode",{parentName:"li"},"docker compose logs -t -f <service_name>")," from command line, where ",(0,l.kt)("inlineCode",{parentName:"li"},"<service_name>")," is one of ",(0,l.kt)("inlineCode",{parentName:"li"},"web"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"prosody"),",",(0,l.kt)("inlineCode",{parentName:"li"},"jvb"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"jicofo"),". This command will output the logs for the selected service to stdout with timestamps."),(0,l.kt)("li",{parentName:"ul"},"use a standard ",(0,l.kt)("a",{parentName:"li",href:"https://docs.docker.com/config/containers/logging/configure/"},"docker logging driver")," to redirect the logs to the desired target (for instance ",(0,l.kt)("inlineCode",{parentName:"li"},"syslog")," or ",(0,l.kt)("inlineCode",{parentName:"li"},"splunk"),")."),(0,l.kt)("li",{parentName:"ul"},"search ",(0,l.kt)("a",{parentName:"li",href:"https://hub.docker.com/search?q="},"docker hub")," for a third party ",(0,l.kt)("a",{parentName:"li",href:"https://docs.docker.com/config/containers/logging/plugins/"},"docker logging driver plugin")),(0,l.kt)("li",{parentName:"ul"},"or ",(0,l.kt)("a",{parentName:"li",href:"https://docs.docker.com/engine/extend/plugins_logging/"},"write your own driver plugin")," if you have a very specific need.")),(0,l.kt)("p",null,"For instance, if you want to have all logs related to a ",(0,l.kt)("inlineCode",{parentName:"p"},"<service_name>")," written to ",(0,l.kt)("inlineCode",{parentName:"p"},"/var/log/jitsi/<service_name>")," as ",(0,l.kt)("inlineCode",{parentName:"p"},"json")," output, you could use ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/deep-compute/docker-file-log-driver"},"docker-file-log-driver")," and configure it by adding the following block in your ",(0,l.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file, at the same level as the ",(0,l.kt)("inlineCode",{parentName:"p"},"image")," block of the selected ",(0,l.kt)("inlineCode",{parentName:"p"},"<service_name>"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'services:\n    <service_name>:\n        image: ...\n        ...\n        logging:\n            driver: file-log-driver\n            options:\n                fpath: "/jitsi/<service_name>.log"\n')),(0,l.kt)("p",null,"If you want to only display the ",(0,l.kt)("inlineCode",{parentName:"p"},"message")," part of the log in ",(0,l.kt)("inlineCode",{parentName:"p"},"json")," format, simply execute the following command (for instance if ",(0,l.kt)("inlineCode",{parentName:"p"},"fpath")," was set to ",(0,l.kt)("inlineCode",{parentName:"p"},"/jitsi/jvb.log"),") which uses ",(0,l.kt)("inlineCode",{parentName:"p"},"jq")," to extract the relevant part of the logs:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo cat /var/log/jitsi/jvb.log | jq -r '.msg' | jq -r '.message'\n")),(0,l.kt)("h2",{id:"build-instructions"},"Build Instructions"),(0,l.kt)("p",null,"Building your images allows you to edit the configuration files of each image individually, providing more customization for your deployment."),(0,l.kt)("p",null,"The docker images can be built by running the ",(0,l.kt)("inlineCode",{parentName:"p"},"make")," command in the main repository folder. If you need to overwrite existing images from the remote source, use ",(0,l.kt)("inlineCode",{parentName:"p"},"FORCE_REBUILD=1 make"),"."),(0,l.kt)("p",null,"If you are on the unstable branch, build the images with ",(0,l.kt)("inlineCode",{parentName:"p"},"FORCE_REBUILD=1 JITSI_RELEASE=unstable make"),"."),(0,l.kt)("p",null,"You are now able to run ",(0,l.kt)("inlineCode",{parentName:"p"},"docker compose up")," as usual."),(0,l.kt)("h2",{id:"running-behind-a-reverse-proxy"},"Running behind a reverse proxy"),(0,l.kt)("p",null,"By default this setup is using WebSocket connections for 2 core components:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Signalling (XMPP)"),(0,l.kt)("li",{parentName:"ul"},"Bridge channel (colibri)")),(0,l.kt)("p",null,"Due to the hop-by-hop nature of WebSockets the reverse proxy must properly terminate and forward WebSocket connections. There 2 routes require such treatment:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"/xmpp-websocket"),(0,l.kt)("li",{parentName:"ul"},"/colibri-ws")),(0,l.kt)("p",null,"With nginx, these routes can be forwarded using the following config snippet:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-nginx"},'location /xmpp-websocket {\n    proxy_pass https://localhost:8443;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "upgrade";\n}\nlocation /colibri-ws {\n    proxy_pass https://localhost:8443;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "upgrade";\n}\n')),(0,l.kt)("p",null,"In addition we need a route for /http-bind as XMPP over BOSH is still used by mobile clients:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-nginx"},'location /http-bind {\n    proxy_pass https://localhost:8443;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "upgrade";\n}\n')),(0,l.kt)("p",null,"With apache, ",(0,l.kt)("inlineCode",{parentName:"p"},"mod_proxy")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"mod_proxy_wstunnel")," need to be enabled and these routes can be forwarded using the following config snippet:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-apache"},'<IfModule mod_proxy.c>\n    <IfModule mod_proxy_wstunnel.c>\n        ProxyTimeout 900\n        <Location "/xmpp-websocket">\n            ProxyPass "wss://localhost:8443/xmpp-websocket"\n        </Location>\n        <Location "/colibri-ws/">\n            ProxyPass "wss://localhost:8443/colibri-ws/"\n        </Location>\n        <Location "/http-bind">\n            ProxyPass "http://localhost:8443/http-bind"\n        </Location>\n    </IfModule>\n</IfModule>\n')),(0,l.kt)("p",null,"where ",(0,l.kt)("inlineCode",{parentName:"p"},"https://localhost:8443/")," is the url of the web service's ingress."),(0,l.kt)("h3",{id:"disabling-websocket-connections"},"Disabling WebSocket connections"),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"This is not the recommended setup.")),(0,l.kt)("p",null,"If using WebSockets is not an option, these environment variables can be set to fallback to HTTP polling and WebRTC datachannels:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ENABLE_SCTP=1\nENABLE_COLIBRI_WEBSOCKET=0\nENABLE_XMPP_WEBSOCKET=0\n")))}k.isMDXComponent=!0},168:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/docker-jitsi-meet-afafdf87fea30a2fa6412baa4a3f8248.png"}}]);